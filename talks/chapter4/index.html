<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Designing CNNs for Secure Inference</title>
        <meta name="author" content="Vishnu Boddeti">

        <link rel="stylesheet" href="../../assets/revealjs/dist/reset.css">
        <link rel="stylesheet" href="../../assets/revealjs/dist/reveal.css">
        <link rel="stylesheet" href="../../assets/revealjs/dist/theme/vishnu.css" id="theme">
        <link rel="stylesheet" href="../../assets/revealjs/plugin/highlight/monokai.css" id="highlight-theme">

        <!-- tikzjax -->
        <link rel="stylesheet" type="text/css" href="../../assets/tikzjax/fonts.css">
        <script src="../../assets/tikzjax/tikzjax.js"></script>

        <!-- CDN for plotly and fontawesome -->
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        <script src="https://kit.fontawesome.com/7a9386c7a8.js" crossorigin="anonymous"></script>

        <!-- Theme used for syntax highlighted code -->
        <style>
            .reveal code,
            .reveal .formula-source,
            .reveal a {
                color: #3F988E;
            }
            .reveal code {
                padding: 0 0.25em;
            }
            .reveal pre.formula-source {
                box-shadow: none;
                font-size: 0.8em;
            }
            .reveal .formula,
            .reveal .formula-source {
                margin: 2.5rem 0;
            }
            .reveal li {
                margin: 0.65em 0;
            }
            .reveal .formula.bigger {
                font-size: 1.8em;
            }

            /*https://medium.com/@mandieq/beautiful-presentations-from-markdown-who-knew-it-could-be-so-easy-d279aa7f787a*/

            #left {
                margin-left: auto;
                margin-right: auto;
                text-align: center;
                float: left;
                z-index:-10;
                font-size: 0.85em;
                line-height: 1.5;
            }

            #right {
                margin-left: auto;
                margin-right: auto;
                text-align: center;
                float: right;
                z-index:-10;
                font-size: 0.85em;
                line-height: 1.5;
            }

            #center {
                margin-left: auto;
                margin-right: auto;
                float: center;
                text-align: center;
                z-index:-10;
                font-size: 0.85em;
                line-height: 1.5;
            }

            #alert {
                background-color: #ff9800;
                padding: 10px;
            }

            #customers {
              border-collapse: collapse;
              width: 100%;
            }
            #customers td, #customers th {
              border: 1px solid #ddd;
              padding: 8px;
            }
            /*#customers tr:nth-child(even){background-color: #f2f2f2;}*/
            #customers tr:hover {background-color: #000000;}
            #customers th {
              padding-top: 12px;
              padding-bottom: 12px;
              text-align: left;
              background-color: #4CAF50;
              color: white;
            }

            #mytable {
              border-collapse: collapse;
              width: 100%;
            }
            #mytable td, #mytable th {
              border: 1px solid #ddd;
              padding: 8px;
            }
            /*#mytable tr:nth-child(even){background-color: #f2f2f2;}*/
            #mytable tr:hover {background-color: #000000;}
            #mytable th {
              padding-top: 12px;
              padding-bottom: 12px;
              text-align: left;
              color: white;
            }

            .box {
              width: 100%;
              background-color: #333333;
              border: 2px solid #ccc;
              border-radius: 5px;
              padding: 0px;
              margin: 0px;
              color:#eeeeec;
            }
          
            .box-header {
              background-color: #337ab7;
              color: #fff;
              padding: 5px;
              border-radius: 5px 5px 0 0;
            }

            .red-box-header {
              background-color: indianred;
              color: #fff;
              padding: 5px;
              border-radius: 5px 5px 0 0;
            }

            .green-box-header {
              background-color: #BAB86C;
              color: black;
              padding: 5px;
              border-radius: 5px 5px 0 0;
            }
        </style>
    </head>

    <body>
        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">

                <!-- Color ramp: ["#559EB1", "#6DB28B", "#8CBB68", "#AFBD4F", "#CFB541", "#E39B39", "#E56E30"] -->

<section data-background-iframe="../../../assets/viz/gradient/">
    <p class="title">Designing CNNs for Secure Inference</p>
    <br>
    <p class="subtitle"> CVPR Tutorial </p>
    <p class="author"> Vishnu Boddeti </p>
    <p class="date">June 19, 2023</p>
    <p><i class="fab fa-twitter"></i> VishnuBoddeti</p>
</section>

<section data-background="white">
    <h2 class="r-fit-text" style="color:black">Machine Learning as a Service (MLaaS)</h2>
    <figure><img src="/assets/images/talks/autofhe/MLaaS.png" alt="" width="100%"></figure>
    <ul style="color:black;font-size:50%">Image Credit: <a href="https://blog.openmined.org/what-is-homomorphic-encryption/">https://blog.openmined.org/what-is-homomorphic-encryption/</a></ul>
</section>

<section>
    <h2 class="r-fit-text">Fully Homomorphic Encryption (FHE)</h2>
    <span class="fragment" data-fragment-index="0">
    <div class="box" style="width:100%">
        <div class="box-header" style="font-size:75%;">Representation over Cyclotomic Polynomial Rings</div>
        <div class="box-content">
            <ul style="font-size:60%;">
                <li><span style="color:cyan">Message</span> $\bm{m}\in \mathbb{C}^{\frac{N}{2}}$ <span style="color:cyan">Plaintext</span> $\mu \in \mathcal{R}_{Q_\ell} = \mathbb{Z}_{Q_\ell}[X]/(X^N+1)$ <span style="color:cyan">Ciphertext</span> $\bm{c}=(c_0, c_1) \in \mathcal{R}_{Q_\ell}^2$ <span style="color:cyan">Level</span> $0\leq l\leq L$, multiplication consumes one level $l-1$. <span style="color:cyan">Bootstrapping</span> can refresh $0$-level ciphtertext.</li>
            </ul>
        </div>
    </div>
    </span>
    <br>
    <div id="left" style="width:50%;">
        <center>
        <span class="fragment" data-fragment-index="1">
        <div class="box" style="width:90%">
            <div class="green-box-header" style="font-size:75%;">FHE Primitives</div>
            <div class="box-content">
                <ul style="font-size:60%;">
                    <li>Generate Keys:</li>
                    <ul>
                        <li><span style="color:cyan">secret key: </span>$s\gets\mathcal{R}_{Q_\ell}$</li>
                        <li><span style="color:cyan">public key: </span>$\bm{p}=(-as+e,a)$, $a,e\gets\mathcal{R}_{Q_\ell}$</li>
                    </ul>
                    <li>Encryption: $\bm{c}=(\mu, 0)+\bm{p}=(\mu-as+e,a)=(c_0,c_1)$</li>
                    <li>Decryption: $c_0+c_1s=\mu-as+e+as=\mu+e\approx \mu$</li>
                </ul>
            </div>
        </div>
        </span>
        </center>
    </div>
    <div id="right" style="width:50%;">
        <center>
        <span class="fragment" data-fragment-index="2">
        <div class="box" style="width:90%">
            <div class="green-box-header" style="font-size:75%;">Homomorphic Operations</div>
            <div class="box-content">
                <ul style="font-size:60%;">
                    <li>Addition: $\bm{c} \oplus \bm{c}^\prime \cong \bm{m} + \bm{m}^\prime$</li>
                    <br>
                    <li>Multiplication: $\bm{c}\otimes \bm{c}^\prime  \cong \bm{m} \odot \bm{m}^\prime$</li>
                    <br>
                    <li>Rotation: $\mathrm{Rot}(\bm{c}, l) \cong \mathrm{Rot}(\bm{m}, l)$ </li>
                </ul>
            </div>
        </div>
        </span>
        </center>
    </div>
    <div id="left" style="width:100%;">
        <br>
        <span  class="fragment" data-fragment-index="3">
        <div class="box" style="width:100%;">
            <div class="red-box-header" style="font-size:75%">Activation Functions in FHE</div>
            <div class="box-content" style="font-size:75%;">
                Non-linear activation functions, like ReLU, are not supported on FHE.
            </div>
        </div>
        </span>
    </div>
</section>

<section data-background="white">
    <h2 style="color:black;">Polynomial Evaluation under FHE</h2>
    <figure><img src="/assets/images/talks/autofhe/CKKS.svg" alt="" width="100%"></figure>
</section>

<section>
    <h2>Complexity of FHE Operations</h2>
    <div id="left" style="width:50%;">
        <center><div id="fhe_complexity" style="width:100%;"></div></center>
        <script>
            var d3colors = Plotly.d3.scale.category10();
            var xlabels = ['Add', 'Mul: Cipher-Plain', 'Rotate', 'Mul: Cipher-Cipher', 'Boostrapping']
            var yValues = [0.2, 0.5, 15.5, 17.3, 2160]
            var trace = {
                type: 'bar',
                x: xlabels,
                y: yValues,
                text: yValues.map(String),
                textfont: {color: ['white', 'black', 'white', 'white', 'white']},
                textposition: 'auto',
                marker: {
                    color: ['rgba(204,204,204,1)', 'rgba(204,204,204,1)', '#337ab7', '#337ab7', 'indianred']
                },
            };
            var data = [ trace ];
            var config = {responsive: true, displaylogo: false};
            var layout = {
                title: 'Op Latency in FHE',
                font: {size: 12, color: "#FFFFFF"},
                plot_bgcolor:"#333333",
                paper_bgcolor:"#333333",
                yaxis: {color: "white"},
                yaxis: {color: "white", showline: true, mirror: true, type: 'log', autorange: true},
                xaxis: {color: "white", showline: true, mirror: true},
            }
            Plotly.newPlot('fhe_complexity', data, layout, config );
        </script>
    </div>

    <div id="right" style="width:50%;">
        <br><br><br><br>
        <center>
            <div class="box" style="width:100%;">
                <div class="red-box-header" style="font-size:75%">Primary Bottleneck: Bootstrapping</div>
                <div class="box-content" style="font-size:75%;">
                    <ul><ul style="font-size:75%;">
                        <li>Evaluating a <span style="color:orange">deep</span> neural network necessitates bootstrapping</li>
                        <li>Bootstrapping dominates latency ($\mathbf{>70\%}$ of execution time)</li>
                    </ul></ul>
                </div>
            </div>
        </center>
    </div>
</section>

<section data-background="white">
    <h2 style="color:black;">Convolution under FHE</h2>
    <figure><img src="/assets/images/talks/autofhe/fhe_conv.png" alt="" width="90%"></figure>
    <hr>
    <ul style="font-size:50%;color:black"><li>Low-Complexity Convolutional Neural Networks on Fully Homomorphic Encryption Using Multiplexed Parallel Convolutions, ICML 2022</li></ul>
</section>

<section data-background="white">
    <h2 style="color:black;">Convolution under FHE</h2>
    <figure><img src="/assets/images/talks/autofhe/ckks_conv.svg" alt="" width="90%"></figure>
</section>

<section data-background="white">
    <h2 style="color:black">Polynomial Approximation of ReLU</h2>
    <div id="left" style="width:50%;">
        <span class="fragment">
        <ul style="color:black;font-size:75%"><li><b>Low-Degree: <i class="far fa-smile-beam fa-lg"></i> Levels $\Downarrow$, <i class="far fa-sad-cry fa-lg"></i> precision $\Downarrow$</b> </li></ul>
        <figure><img src="/assets/images/talks/autofhe/faster_relu.svg" alt="" width="90%"></figure>
        <ul><ul style="font-size:50%;color:black"><li>Faster CryptoNets: Leveraging Sparsity for Real-World Encrypted Inference</li></ul></ul>
        </span>
    </div>
    <div id="right" style="width:50%;">
        <span class="fragment">
        <ul style="color:black;font-size:75%"><li><b>High-Degree: <i class="far fa-sad-cry fa-lg"></i> Levels $\Uparrow$, <i class="far fa-smile-beam fa-lg"></i> precision $\Uparrow$</b> </li></ul>
        <figure><img src="/assets/images/talks/autofhe/minimax_relu.png" alt="" width="90%"></figure>
        <ul><ul style="font-size:50%;color:black"><li>Precise Approximation of Convolutional Neural Networks for Homomorphically Encrypted Data</li></ul></ul>
        </span>
    </div>
</section>

<section>
    <h2>CNNs under FHE</h2>
    <div id="left" style="width:50%;">
        <br>
        <table>
            <tr>
                <th>Operations</th>
                <th>Support</th>
              </tr>
            <tr>
                <td>Conv2D</td>
                <td><span>&#10003;</span></td>
            </tr>
            <tr>
                <td>BatchNorm2D</td>
                <td><span>&#10003;</span></td>
            </tr>
            <tr>
                <td>AvgPool</td>
                <td><span>&#10003;</span></td>
            </tr>
            <tr>
                <td>Linear</td>
                <td><span>&#10003;</span></td>
            </tr>
            <tr>
                <td>ReLU</td>
                <td>&#10060;</td>
            </tr>
            <tr>
                <td>Bootstrapping</td>
                <td><span>&#10003;</span></td>
            </tr>
        </table>
    </div>
    <div id="right" style="width:50%;">
        <span class="fragment">
        <center><div id="cnn_fhe_complexity" style="width:90%;"></div></center>
        <script>
            var d3colors = Plotly.d3.scale.category10();
            var xlabels = ['Conv2D', 'BatchNorm2D', 'AvgPool', 'Linear', 'Boostrapping']
            var yValues = [32, 1, 3, 13, 403]
            var trace = {
                type: 'bar',
                x: xlabels,
                y: yValues,
                text: yValues.map(String),
                textfont: {color: ['black', 'white', 'white', 'white', 'white']},
                textposition: 'auto',
                marker: {
                    color: ['rgba(204,204,204,1)', 'rgba(204,204,204,1)', '#337ab7', '#337ab7', 'indianred']
                },
            };
            var data = [ trace ];
            var config = {responsive: true, displaylogo: false};
            var layout = {
                title: 'CIFAR 32x32 Latency on CPU',
                font: {size: 12, color: "#FFFFFF"},
                plot_bgcolor:"#333333",
                paper_bgcolor:"#333333",
                yaxis: {color: "white"},
                yaxis: {color: "white", showline: true, mirror: true, type: 'log', autorange: true},
                xaxis: {color: "white", showline: true, mirror: true},
            }
            Plotly.newPlot('cnn_fhe_complexity', data, layout, config );
        </script>
        </span>
    </div>
    <div id="left" style="width:100%;">
        <span class="fragment">
        <div class="box" style="width:100%">
            <div class="box-header">Polynomial Approximation of ReLU</div>
            <div class="box-content">
                <ul><ul style="font-size:75%;">
                    <li><span style="color:orange">Level</span> consumption/multiplication <span style="color:orange">Depth</span> = $\log_2\lceil\text{degree}\rceil$</li>
                    <li>Degree $\mapsto$ Level consumption $\Uparrow$ $\mapsto$ Bootstrapping $\Uparrow$ $\mapsto$ Latency $\Uparrow\Uparrow\Uparrow$</li>
                </ul></ul>
            </div>
        </div>
        </span>
    </div>
</section>

<section data-background="white">
    <h2 style="color:black;" class="r-fit-text">FHE-MP-CNN: a High-degree Polynomial Solution</h2>
    <div id="left" style="width:50%;">
        <ul style="color:black;font-size:75%"><li>Homomorphic evaluation architecture of ResNets</li></ul>
    </div>
    <div id="right" style="width:50%;">
        <ul style="color:black;font-size:75%"><li>Experimental results on CIFAR datasets</li></ul>
    </div>
    <div id="left" style="width:50%;">
        <figure><img src="/assets/images/talks/autofhe/mp_resnet.png" alt="" width="90%"></figure>        
    </div>
    <div id="right" style="width:50%;">
        <br>
        <figure><img src="/assets/images/talks/autofhe/mp_result.png" alt="" width="90%"></figure>
    </div>
    <div id="left" style="width:100%;"></div>
    <div id="left" style="width:50%;">
        <ul style="color:black;font-size:50%"><li>High-degree polynomials $\rightarrow$ Levels $\Uparrow \rightarrow$ Bootstrapping $\Uparrow \rightarrow$ Latency $\Uparrow$ <i class="far fa-sad-cry fa-lg"></i></li></ul>
    </div>
    <div id="right" style="width:50%;">
        <ul style="color:black;font-size:50%"><li>High-degree polynomials $\rightarrow$ Approximation Precision $\Uparrow \rightarrow$ Accuracy $\Uparrow$ <i class="far fa-smile-beam fa-lg"></i></li></ul>
    </div>
    <div id="left" style="width:100%;">
        <ul style="font-size:50%;color:black"><li>Low-Complexity Convolutional Neural Networks on Fully Homomorphic Encryption Using Multiplexed Parallel Convolutions, ICML 2022</li></ul>
    </div>
</section>

<section>
    <h2>Multi-Objective Conflict</h2>
    <div class="box">
        <div class="red-box-header">Conflict between Latency and Accuracy</div>
        <div class="box-content">
            <ul style="font-size:75%;">
                <li>Latency</li>
                <ul><li>Low-degree Polynomials $\rightarrow$ Level Consumption $\Downarrow \rightarrow$ Bootstrapping $\Downarrow \rightarrow$ Latency $\Downarrow$</li></ul>
                <li>Accuracy</li>
                <ul><li>High-degree Polynomials $\rightarrow$ Approximation Precision $\Uparrow \rightarrow$ Accuracy $\Uparrow$</li></ul>
            </ul>
        </div>
    </div>
    <br>
    <div id="left" style="width:50%;">
        <center>
        <span class="fragment">
        <div class="box" style="width:90%;">
            <div class="green-box-header">Layerwise Polynomials</div>
            <div class="box-content">
                <ul style="font-size:75%;"><li>Layerwise mixed-degree polynomial networks leverage layerwise approximation sensitivity to accelerate inference while preserving accuracy.</li></ul>
            </div>
        </div>
        </span>
        </center>
    </div>
    <div id="right" style="width:50%;">
        <center>
        <span class="fragment">
        <div class="box" style="width: 90%;">
            <div class="green-box-header">Learn Polynomials and Networks</div>
            <div class="box-content">
                <ul style="font-size:75%;"><li>Leverage both polynomial approximation of ReLU and learn neural network weights using gradient descent.</li></ul>
            </div>
        </div>
        </span>
        </center>
    </div>
</section>

<section data-background="white">
    <h2 style="color:black">Bi-Level Multi-Objective Framework</h2>
    <figure><img src="/assets/images/talks/autofhe/overview.svg" alt="" width="100%"></figure>
    <center style="color:black;font-size:75%">&#x2705 Layerwise Polynomials &#x2705 Diverse Solutions &#x2705 Better Trade-off Fronts</center>
</section>

<section data-background="white">
    <h2 style="color:black">Framework Overview</h2>
    <figure><img src="/assets/images/talks/autofhe/algo.svg" alt="" width="100%"></figure>
    <br>
    <div class="box" style="background-color:white">
        <div class="red-box-header">Full Search Algorithm</div>
        <div class="box-content" style="color:white">
            <ul style="font-size:75%;color:black">
                <li>MOCoEv: Multi-Objective CoEvolutionary algorithm searches for layerwise polynomials</li>
                <li>R-CCDE: Regularized Cooperative Coevolution Differentiable Evolution optimizes coefficients</li>
                <li>PAT: Polynomial-Aware Training can avoid gradient exploding due to polynomials</li>
            </ul>
            <center style="color:black">&#x2705 Forward: Evaluate Polynomials &#x2705 Backward: Evaluate ReLU</center>
        </div>
    </div>
</section>

<section data-background="white">
    <h2 style="color:black" class="r-fit-text">Flexible Homomorphic Encryption Architecture</h2>
    <br>
    <figure><img src="/assets/images/talks/autofhe/connection.svg" alt="" width="100%"></figure>
</section>

<section data-background="white">
    <h2 style="color:black">Evolving Composite Polynomials</h2>
    <div class="box" style="width:auto;background-color:white">
        <div class="box-header">EvoReLU: a composite polynomial</div>
        <div class="box-content">
            <ul><ul style="color:black;font-size:75%">
                <li>$\mathrm{EvoReLU}(x)=x\cdot(0.5+p^d(x))$ by using $\mathrm{ReLU}(x)=x\cdot(0.5+0.5\cdot\mathrm{sgn}(x))$</li>
                <li>Composite polynomial $p^d(x)=(p_K^{d_K}\circ\cdots\circ p_2^{d_2}\circ p_1^{d_1})(x)$ </li>
                <li>Sub-polynomial $p_k(x)=(1/\beta_k)\sum_{i=1}^{d_k} \alpha_i T_i(x)$, $T_i(x)$ is Chebyshev basis</li>
                <li>Search for number of sub-polynomials <span style="color:blue">$K$</span>, degrees <span style="color:blue">$\{d_k\}_{k=1}^{d_K}$</span> and coefficients <span style="color:blue">$\{\bm{\alpha}_k, \beta_k\}_{k=1}^K$</span></li>
            </ul></ul>
        </div>
    </div>
    <br>
    <div id="right" style="width:50%;">
        <span class="fragment">
        <div class="box" style="background-color:white;">
            <div class="box-header">Search Variables</div>
            <div class="box-content">
                <table style="color:black;font-size:75%">
                    <tr>
                        <th>Variable</th>
                        <th>Options</th>
                      </tr>
                    <tr>
                        <td># polynomials $(K)$</td>
                        <td>6</td>
                    </tr>
                    <tr>
                        <td>poly degree $()d_k$</td>
                        <td>{0,1,3,5,7}</td>
                    </tr>
                    <tr>
                        <td>coefficients $(\Lambda)$</td>
                        <td>$\mathbb{R}$</td>
                    </tr>
                </table>
            </div>
        </div>
        </span>
    </div>
    <div id="left" style="width:50%;">
        <figure class="fragment"><img src="/assets/images/talks/autofhe/mutation.svg" alt="" width="95%"></figure>
    </div>
</section>

<section>
    <h2>Search Space</h2>
    <div class="box">
        <div class="green-box-header">Search Space</div>
        <div class="box-content">
            <ul><ul>
                <li>High-dimensional multi-objective optimization</li>
                <li>Extremely large search space</li>
            </ul></ul>
            <table>
                <tr>
                    <th>Backbone</th>
                    <th># EvoReLU</th>
                    <th># Sub-polynomial</th>
                    <th>Search Space Size</th>
                </tr>
                <tr>
                    <td>ResNet-20</td>
                    <td>19</td>
                    <td>114</td>
                    <td>$10^{79}$</td>
                </tr>
                <tr>
                    <td>ResNet-32</td>
                    <td>31</td>
                    <td>186</td>
                    <td>$10^{130}$</td>
                </tr>
                <tr>
                    <td>ResNet-44</td>
                    <td>43</td>
                    <td>258</td>
                    <td>$10^{180}$</td>
                </tr>
                <tr>
                    <td>ResNet-56</td>
                    <td>55</td>
                    <td>330</td>
                    <td>$10^{230}$</td>
                </tr>
            </table>
        </div>
    </div>
</section>

<section>
    <h2>Search Objective</h2>
    <br><br>
    <div class="box">
        <div class="box-header">Search Objective</div>
        <div class="box-content">
            $$
            \begin{aligned}
            \min_{\bm D} & \quad \left\{1-\mathrm{Acc}_{val}\left(f(\bm{\omega}^\ast);\bm{D},\bm{\Lambda}(\bm{D})\right),  \mathrm{Boot}(\bm D) \right\} \\
            & \quad \bm{\omega}^\ast = \argmin_{\bm{\omega}} \mathcal{L}_{train} \left( f(\bm{\omega});\bm{D},\bm{\Lambda}(\bm{D}) \right)
            \end{aligned}
            $$
            <center style="font-size:75%;">$\bm{D}$ all degrees, $\bm{\Lambda}(\bm{D})$ all coefficients, $\bm{\omega}$ network weight, $ \mathrm{Boot}(\bm D)$ #bootstrapping operations</center>
        </div>
    </div>
</section>

<section data-background="white">
    <h2 style="color:black">MOCoEV</h2>
    <figure><img src="/assets/images/talks/autofhe/algo.svg" alt="" width="100%"></figure>
    <div class="box" style="width:auto;background-color:white">
        <div class="red-box-header">Operations</div>
        <div class="box-content">
            <ul><ul style="font-size:70%;color:black;line-height:75%">
                <li><b>Selection:</b> Randomly select $N$ solutions from current trade-off front to build a mating set.</li>
                <li><b>Crossover</b> enables network-level information exchange. </li>
                <li><b>Mutation</b> is a coevolutionary operation. Explores the $m$-th layer with other layers fixed.</li>
                <li><b>R-CCDE</b> optimizes polynomial coefficients.</li>
                <li><b>PAT</b> fine-tunes new solutions $\{\bm{D}_j^\prime, \bm{\Lambda}_j^\prime\}_{j=1}^N$.</li>
                <li><b>Evaluate</b> accuracy and count bootstrapping.</li>
                <li><b>Update</b> trade-off front.</li>
            </ul></ul>
        </div>
    </div>
</section>

<!-- <section>
    <h2 class="r-fit-text">R-CCDE: Optimize Coefficients via Differentiable Evolution (DE)</h2>
    <div class="box" style="width:100%;">
        <div class="box-header">Differentiable Evolution (DE): a gradient-free optimization</div>
        <div class="box-content">
            <ul><li>To optimize variables in continuous space, $\bm{x}^\ast = \argmin_{\bm{x}} \mathcal{F}\left(\bm{x}\right)$, DE operations are defined as:</li></ul>
            $$
            \begin{aligned}
            \text{Mutation:}\; & \bm{v} = \bm{x}_i + F \cdot \left( \bm{x}_j - \bm{x}_k \right), 1 \leq i,j,k \leq N \\
            \text{Crossover:}\; & \bm{u}[t] = \begin{cases}
                    \bm{v}[t],&\mathcal{U}(0, 1) \leq CR\\
                    \bm{x}_i[t],& \text{Otherwise}
            \end{cases}, 1\leq t \leq d \\
            \text{Selection:}\; & \bm{u} = \begin{cases}
                    \bm{u},&\mathcal{F}(\bm{u}) \leq \mathcal{F}(\bm{x}_i)\\
                    \bm{x}_i,& \text{Otherwise}
            \end{cases}
            \end{aligned}
            $$
            <ul><li>where $F\in\mathbb{R}$ is the scaling factor, $CR\in\mathbb{R}$ is the crossover rate, and $\mathcal{U}(0,1)$ is the uniform distribution.</li></ul>
        </div>
    </div>
</section> -->

<section data-background="white">
    <h2 style="color:black">R-CCDE Algorithm</h2>
    <figure><img src="/assets/images/talks/autofhe/r-ccde-algorithm.png" alt="" width="100%"></figure>
</section>

<section data-background="white">
    <h2 style="color:black" class="r-fit-text">R-CCDE: Optimize Polynomial Coefficients</h2>
    <figure><img src="/assets/images/talks/autofhe/poly-reu.svg" alt="" width="100%"></figure>
</section>

<section>
    <h2 class="r-fit-text">AutoFHE: Bi-Level Multi-Objective Search</h2>
    <div class="box" style="width:auto;">
        <div class="red-box-header" style="font-size:75%">Experimental Setup</div>
        <div class="box-content" style="font-size:75%;">
            <ul><ul style="font-size:75%;">
                <li><span style="color:cyan">Hyperparameters: </span>Generations 20, Population size 50, Coefficient search space $[-5, 5]$, DE population size $10\times\#$variables, Replace sub-polynomial $0.5$, remove sub-polynomial $0.4$, insert sub-polynomial $0.1$</li>
                <li><span style="color:cyan">Time Complexity: </span>On one NVIDIA RTX A6000 GPU, search process for ResNet-20/32/44/56 on CIFAR-10 took <b> 59</b> hours, <b> 126</b> hours, <b> 200</b> hours, <b> 281</b> hours, respectively. The search for ResNet-32 on CIFAR-100 took <b>140</b> hours.</li>
            </ul></ul>
        </div>
    </div>
    <div id="left" style="width:66%">
        <center><div id="autofhe-r32-cifar10" style="width:99%;"></div></center>
        <script>
            var d3colors = Plotly.d3.scale.category10();
            
            var xlabels1 = [7,8,11,12,13,14,15,16]
            var yValues1 = [41.6, 88.47, 91.17,91.56,91.66,91.67,91.73,91.81]
            var trace1 = {
                type: 'plot',
                x: xlabels1,
                y: yValues1,
                name: 'ResNet-20',
                mode: 'lines+markers',
                hoverinfo: 'x+y',
                xaxis: 'x1',
                yaxis: 'y1',
            };

            var xlabels2 = [13,14,15,16,17,19,20,21,24,25,27,29]
            var yValues2 = [10.0,91.12,91.77,92.27,92.55,92.66,92.72,92.75,92.79,92.86,92.89,92.90]
            var trace2 = {
                type: 'plot',
                x: xlabels2,
                y: yValues2,
                name: 'ResNet-32',
                mode: 'lines+markers',
                hoverinfo: 'x+y',
                xaxis: 'x2',
                yaxis: 'y2',
            };

            var xlabels3 = [19,20,21,22,23,24,25,26,27,28,30,31,32,33,34,36,37]
            var yValues3 = [10.0, 51.32, 90.17, 90.97, 91.44, 91.55, 91.79, 91.96, 92.24, 92.16, 92.26, 92.37, 92.40, 92.65, 92.83, 92.79, 92.85]
            var trace3 = {
                type: 'plot',
                x: xlabels3,
                y: yValues3,
                name: 'ResNet-44',
                mode: 'lines+markers',
                hoverinfo: 'x+y',
                xaxis: 'x3',
                yaxis: 'y3',
            };

            var xlabels4 = [25,29,30,31,32,33,34,35,36,38,39,40,41,42,44,45,47]
            var yValues4 = [10.0,91.69,91.92,92.16,92.47,92.82,92.98,92.91,93.03,92.89,93.02,93.12,93.12,93.22,93.19,93.29,93.42]
            var trace4 = {
                type: 'plot',
                x: xlabels4,
                y: yValues4,
                name: 'ResNet-56',
                mode: 'lines+markers',
                hoverinfo: 'x+y',
                xaxis: 'x4',
                yaxis: 'y4',
            };
            
            var data = [ trace1, trace2, trace3, trace4 ];
            var config = {responsive: true, displaylogo: false};
            var layout = {
                grid: {rows: 2, columns: 2, pattern: 'independent'},
                title: 'CIFAR-10',
                font: {size: 12, color: "#FFFFFF"},
                plot_bgcolor:"#333333",
                paper_bgcolor:"#333333",
                yaxis1: {color: "white", showline: true, mirror: true, title:"Accuracy (%)"},
                xaxis1: {color: "white", showline: true, mirror: true},
                yaxis2: {color: "white", showline: true, mirror: true},
                xaxis2: {color: "white", showline: true, mirror: true},
                yaxis3: {color: "white", showline: true, mirror: true},
                xaxis3: {color: "white", showline: true, mirror: true, title: "# of Bootstrapping Ops"},
                yaxis4: {color: "white", showline: true, mirror: true},
                xaxis4: {color: "white", showline: true, mirror: true},
                legend: {x: 0.5, y: 1.02, "orientation": "h", yanchor:'bottom', xanchor:'center'},
            }
            Plotly.newPlot('autofhe-r32-cifar10', data, layout, config );
        </script>
    </div>
    <div id="right" style="width:33%">
        <center><div id="autofhe-r32-cifar100" style="width:99%;"></div></center>
        <script>
            var d3colors = Plotly.d3.scale.category10();
            var xlabels1 = [15,16,18,19,20,21,22,23]
            var yValues1 = [62.84,65.26,68.60,68.90,69.23,69.43,69.76,69.99]
            var trace1 = {
                type: 'plot',
                x: xlabels1,
                y: yValues1,
                mode: 'lines+markers',
                hoverinfo: 'x+y',
            };
            var data = [ trace1 ];
            var config = {responsive: true, displaylogo: false};
            var layout = {
                title: 'ResNet-32 on CIFAR-100',
                font: {size: 12, color: "#FFFFFF"},
                plot_bgcolor:"#333333",
                paper_bgcolor:"#333333",
                yaxis: {color: "white", showline: true, mirror: true, title:"Accuracy (%)"},
                xaxis: {color: "white", showline: true, mirror: true, title: "# of Bootstrapping Ops"},
            }
            Plotly.newPlot('autofhe-r32-cifar100', data, layout, config );
        </script>
    </div>
</section>
<section data-background="white">
    <h2 style="color:black">AutoFHE: Better Trade-off</h2>
    <figure><img src="/assets/images/talks/autofhe/cifar-ciphertext_tradoeff.svg" alt="" width="100%"></figure>
</section>

<!-- <section>
    <h2>AutoFHE: Better Trade-off</h2>
    <div id="left" style="width:50%">
        <center><div id="r32-cifar10" style="width:99%;"></div></center>
        <script>
            var d3colors = Plotly.d3.scale.category10();
            var xlabels1 = [84, 89, 108]
            var yValues1 = [92.25, 92.68, 92.88]
            var boot1 = [20, 21, 29]
            var trace1 = {
                type: 'plot',
                x: xlabels1,
                y: yValues1,
                name: 'AutoFHE (MOCoEV)',
                mode: 'lines+markers',
                text: boot1.map(number => "boot:" + number.toString()),
                hoverinfo: 'text+x+y',
            };
            var xlabels2 = [115]
            var yValues2 = [92.40]
            var boot2 = [30]
            var trace2 = {
                type: 'plot',
                x: xlabels2,
                y: yValues2,
                name: 'FHE-MP-CNN (Manual)', 
                mode: 'lines+markers',
                text: boot2.map(number => "boot:" + number.toString()),
                hoverinfo: 'text+x+y',
            };
            var data = [ trace1, trace2 ];
            var config = {responsive: true, displaylogo: false};
            var layout = {
                title: 'ResNet-32 on CIFAR-10',
                font: {size: 12, color: "#FFFFFF"},
                plot_bgcolor:"#333333",
                paper_bgcolor:"#333333",
                yaxis: {color: "white"},
                yaxis: {color: "white", showline: true, mirror: true, title:"Accuracy (%)"},
                xaxis: {color: "white", showline: true, mirror: true, title: "Inference Time (s)"},
                legend: {
                    xanchor: 'right',
                    yanchor: 'bottom',
                    x: 1.00,
                    y: 0.40
                },
            }
            Plotly.newPlot('r32-cifar10', data, layout, config );
        </script>
    </div>
    <div id="right" style="width:50%">
        <center><div id="r32-cifar100" style="width:99%;"></div></center>
        <script>
            var d3colors = Plotly.d3.scale.category10();
            var xlabels1 = [78,91,94]
            var yValues1 = [67.75,68.66,69.37]
            var boot1 = [21,22,23]
            var trace1 = {
                type: 'plot',
                x: xlabels1,
                y: yValues1,
                name: 'AutoFHE (MOCoEV)',
                mode: 'lines+markers',
                text: boot1.map(number => "boot:" + number.toString()),
                hoverinfo: 'text+x+y',
            };
            var xlabels2 = [114]
            var yValues2 = [69.43]
            var boot2 = [30]
            var trace2 = {
                type: 'plot',
                x: xlabels2,
                y: yValues2,
                name: 'FHE-MP-CNN (Manual)', 
                mode: 'lines+markers',
                text: boot2.map(number => "boot:" + number.toString()),
                hoverinfo: 'text+x+y',
            };
            var data = [ trace1, trace2 ];
            var config = {responsive: true, displaylogo: false};
            var layout = {
                title: 'ResNet-32 on CIFAR-100',
                font: {size: 12, color: "#FFFFFF"},
                plot_bgcolor:"#333333",
                paper_bgcolor:"#333333",
                yaxis: {color: "white"},
                yaxis: {color: "white", showline: true, mirror: true, title:"Accuracy (%)"},
                xaxis: {color: "white", showline: true, mirror: true, title: "Inference Time (s)"},
                legend: {
                    xanchor: 'right',
                    yanchor: 'bottom',
                    x: 1.00,
                    y: 0.20
                },
            }
            Plotly.newPlot('r32-cifar100', data, layout, config );
        </script>
    </div>
</section> -->

<section>
    <h2 class="r-fit-text">AutoFHE: Better Trade-off under RNS-CKKS FHE</h2>
    <div id="left" style="width:50%;">
        <br><br><br><br>
        <div class="box" style="width:99%;font-size:75%">
            <div class="box-header">Evaluation under RNS-CKKS FHE</div>
            <div class="box-content"><ul><li>The inference time for 50 images is evaluated on AMD EPYC 7H12 64-core processor with 50 threads.</li></ul></div>
        </div>
    </div>
    <div id="right" style="width:50%;">
        <center><div id="autofhe-results" style="width:99%;"></div></center>
        <script>
            var d3colors = Plotly.d3.scale.category10();
            var xlabels1 = [53, 84, 108, 174]
            var yValues1 = [91.39, 92.25, 92.88, 93.27]
            var boot1 = [13, 20, 29, 47]
            var trace1 = {
                type: 'plot',
                x: xlabels1,
                y: yValues1,
                name: 'AutoFHE (MOCoEV)',
                mode: 'lines+markers',
                text: boot1.map(number => "boot:" + number.toString()),
                hoverinfo: 'text+x+y',
            };
            var xlabels2 = [71, 115, 155, 197]
            var yValues2 = [91.39, 92.40, 92.65, 93.07]
            var boot2 = [18, 30, 42, 54]
            var trace2 = {
                type: 'plot',
                x: xlabels2,
                y: yValues2,
                name: 'FHE-MP-CNN (Manual)', 
                mode: 'lines+markers',
                text: boot2.map(number => "boot:" + number.toString()),
                hoverinfo: 'text+x+y',
            };
            var data = [ trace1, trace2 ];
            var config = {responsive: true, displaylogo: false};
            var layout = {
                title: 'Accuracy vs. Inference Time (sec)',
                font: {size: 12, color: "#FFFFFF"},
                plot_bgcolor:"#333333",
                paper_bgcolor:"#333333",
                yaxis: {color: "white"},
                yaxis: {color: "white", showline: true, mirror: true, title:"Accuracy (%)"},
                xaxis: {color: "white", showline: true, mirror: true, title: "Inference Time (s)"},
                legend: {                    
                    xanchor: 'right',
                    yanchor: 'bottom',
                    x: 1.00,
                    y: 0.10
                },
            }
            Plotly.newPlot('autofhe-results', data, layout, config );
        </script>
    </div>
    <div id="left" style="width:100%;">
    <hr>
    <ul style="font-size:50%;line-height:50%">
        <li>AutoFHE: Automated Adaption of CNNs for Efficient Evaluation over FHE, Cryptology ePrint Archive 2023.</li>
        <li>FHE-MP-CNN: Low-Complexity Convolutional Neural Networks on Fully Homomorphic Encryption Using Multiplexed Parallel Convolutions, ICML 2022 </li>
    </ul>
    </div>
</section>

<section data-background="white">
    <h2 style="color:black">AutoFHE: Layerwise Polynomials</h2>
    <figure><img src="/assets/images/talks/autofhe/evolrelu-distribution.svg" alt="" width="100%"></figure>
</section>

<section>
    <h2>Summary</h2>
    <figure><img src="/assets/images/talks/autofhe/overview.svg" alt="" width="50%"></figure>
    <ul><ul style="font-size:75%">
        <li>Neural networks need to be redesigned for operating on encrypted data.</li>
        <li>Manual design of architecture is difficult, sub-optimal and time-consuming.</li>
        <li>Multi-Objective optimization is an attractive and effective solution in practice.</li>
    </ul>
    </ul>
</section>

            </div>
        </div>
        <script src="../../assets/revealjs/dist/reveal.js"></script>
        <script src="../../assets/revealjs/plugin/notes/notes.js"></script>
        <script src="../../assets/revealjs/plugin/markdown/markdown.js"></script>
        <script src="../../assets/revealjs/plugin/highlight/highlight.js"></script>        
        <script src="../../assets/revealjs/plugin/search/search.js"></script>
        <script src="../../assets/revealjs/plugin/zoom/zoom.js"></script>
        <script src="../../assets/revealjs/plugin/math/math.js"></script>
        
        <script src="../../assets/revealjs/plugin/menu/menu.js"></script>        
        <script src="../../assets/revealjs/plugin/pdfexport/pdfexport.js"></script>

        <!-- chalkboard -->
        <link rel="stylesheet" href="../../assets/revealjs/plugin/chalkboard/style.css">
        <script src="../../assets/revealjs/plugin/chalkboard/plugin.js"></script>

        <!-- customcontrols -->
        <link rel="stylesheet" href="../../assets/revealjs/plugin/customcontrols/style.css">
        <script src="../../assets/revealjs/plugin/customcontrols/plugin.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js-plugins/menu/font-awesome/css/fontawesome.css">

        <!-- chart -->
        <script src="../../assets/revealjs/plugin/chart/Chart.min.js"></script>
        <script src="../../assets/revealjs/plugin/chart/plugin.js"></script>

        <!-- font awesome -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js-plugins/menu/font-awesome/css/fontawesome.css">

        <script>
          Reveal.initialize({
              controls: true,
              progress: true,
              history: true,
              center: true,
              mouseWheel: true,
              hash: true,
              autoPlayMedia: true,
              transition: 'fade',
              touch: true,

              katex: {
                version: 'latest',
                delimiters: [
                  {left: '$$', right: '$$', display: true},
                  {left: '$', right: '$', display: false},
                  {left: '\\(', right: '\\)', display: false},
                  {left: '\\[', right: '\\]', display: true}
               ],
               ignoredTags: ['script', 'noscript', 'style', 'textarea', 'pre']
              },

              chalkboard: {
                  src: "",
                  eraser: { src: path + 'img/sponge.png', radius: 20},
                boardmarkers : [
                        { color: 'rgba(255,220,0,1)', cursor: 'url(' + path + 'img/boardmarker-yellow.png), auto'},
                        { color: 'rgba(30,144,255, 1)', cursor: 'url(' + path + 'img/boardmarker-blue.png), auto'},
                        { color: 'rgba(220,20,60,1)', cursor: 'url(' + path + 'img/boardmarker-red.png), auto'},
                        { color: 'rgba(50,205,50,1)', cursor: 'url(' + path + 'img/boardmarker-green.png), auto'},
                        { color: 'rgba(255,140,0,1)', cursor: 'url(' + path + 'img/boardmarker-orange.png), auto'},
                        { color: 'rgba(100,100,100,1)', cursor: 'url(' + path + 'img/boardmarker-black.png), auto'},
                        { color: 'rgba(150,0,20150,1)', cursor: 'url(' + path + 'img/boardmarker-purple.png), auto'}
                ],
                chalks: [
                        { color: 'rgba(255,255,255,0.5)', cursor: 'url(' + path + 'img/chalk-white.png), auto'},
                        { color: 'rgba(96, 154, 244, 0.5)', cursor: 'url(' + path + 'img/chalk-blue.png), auto'},
                        { color: 'rgba(237, 20, 28, 0.5)', cursor: 'url(' + path + 'img/chalk-red.png), auto'},
                        { color: 'rgba(20, 237, 28, 0.5)', cursor: 'url(' + path + 'img/chalk-green.png), auto'},
                        { color: 'rgba(220, 133, 41, 0.5)', cursor: 'url(' + path + 'img/chalk-orange.png), auto'},
                        { color: 'rgba(220,0,220,0.5)', cursor: 'url(' + path + 'img/chalk-purple.png), auto'},
                        { color: 'rgba(255,220,0,0.5)', cursor: 'url(' + path + 'img/chalk-yellow.png), auto'}
                ]
              },

              chart: {
                defaults: {
                  global: {
                    title: { fontColor: "#FFF" },
                    legend: {
                      labels: { fontColor: "#FFF" },
                    },
                  },
                  scale: {
                    scaleLabel: { fontColor: "#FFF" },
                    gridLines: { color: "#FFF", zeroLineColor: "#FFF" },
                    ticks: { fontColor: "#FFF" },
                  }
                },
                line: { borderColor: [ "rgba(20,220,220,.8)" , "rgba(220,120,120,.8)", "rgba(20,120,220,.8)" ], "borderDash": [ [5,10], [0,0] ]},
                bar: { backgroundColor: [ "rgba(20,220,220,.8)" , "rgba(220,120,120,.8)", "rgba(20,120,220,.8)" ]},
                pie: { backgroundColor: [ ["rgba(0,0,0,.8)" , "rgba(220,20,20,.8)", "rgba(20,220,20,.8)", "rgba(220,220,20,.8)", "rgba(20,20,220,.8)"] ]},
                radar: { borderColor: [ "rgba(20,220,220,.8)" , "rgba(220,120,120,.8)", "rgba(20,120,220,.8)" ]},
              },

              customcontrols: {
                controls: [
                    {
                      id: 'toggle-overview',
                      title: 'Toggle overview (O)',
                      icon: '<i class="fa fa-th" style="color:#5DA8A3"></i>',
                      action: 'Reveal.toggleOverview();'
                    },
                    { icon: '<i class="fa fa-pen-square" style="color:#5DA8A3"></i>',
                      title: 'Toggle chalkboard (B)',
                      action: 'RevealChalkboard.toggleChalkboard();'
                    },
                    { icon: '<i class="fa fa-pen" style="color:#5DA8A3"></i>',
                      title: 'Toggle notes canvas (C)',
                      action: 'RevealChalkboard.toggleNotesCanvas();'
                    }
                ]
              },

              plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealSearch, RevealChalkboard, RevealZoom, RevealMath.KaTeX, RevealMenu, PdfExport, RevealChart ]
          });
        </script>

        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-49985752-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-49985752-2');
</script>

    </body>
</html>
